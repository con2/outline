FROM node:12
RUN groupadd -g 999 -r outline && useradd -r -g outline -u 999 outline
RUN mkdir /usr/src/app
WORKDIR /usr/src/app
COPY package.json yarn.lock /usr/src/app
RUN yarn install --pure-lockfile
COPY . /usr/src/app
RUN chmod 755 docker-entrypoint.sh && yarn build
USER outline
ENTRYPOINT ["/usr/src/app/docker-entrypoint.sh"]
CMD ["node", "index.js"]
